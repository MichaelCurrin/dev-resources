<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">



    <meta property="og:site_name" content="Dev Resources" />

    <title>Server-Side Rendering | Dev Resources</title>

    <meta property="og:title" content="Server-Side Rendering" />

    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Server-Side Rendering" />
<meta name="generator" content="Jekyll v4.3.3" />

<meta property="og:locale" content="en_US" />


    <meta name="description" content="SSR in the context of React" />
    <meta property="og:description" content="SSR in the context of React" />
<meta name="author" content="Michael Currin" />



<link rel="canonical" href="https://michaelcurrin.github.io/dev-resources/resources/javascript/packages/react/ssr.html" />
<meta property="og:url" content="https://michaelcurrin.github.io/dev-resources/resources/javascript/packages/react/ssr.html" />


<script type="application/ld+json">
{
    "name":        "Dev Resources",
    "description": "SSR in the context of React",
    "url":         "https://michaelcurrin.github.io/dev-resources/resources/javascript/packages/react/ssr.html",
    "headline":    "Server-Side Rendering",
    "@type":       "WebSite",
    "@context":    "https://schema.org",
    "author": {
        "@type":"Person",
        "name": "Michael Currin"
    }
}
</script>
<link rel="stylesheet" href="/dev-resources/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://michaelcurrin.github.io/dev-resources/feed.xml" title="Dev Resources" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-5XEV3CEPK9"></script>
    <script>
        window['ga-disable-G-5XEV3CEPK9'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
        window.dataLayer = window.dataLayer || [];

        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-5XEV3CEPK9');
    </script></head>
<body>
<header class="site-header" role="banner">

    <div class="wrapper"><a class="site-title" rel="author" href="/dev-resources/">
            Dev Resources
        </a><nav class="site-nav">
                <input type="checkbox" id="nav-trigger" class="nav-trigger" />

                <label for="nav-trigger">
                    <span class="menu-icon">
                        <svg viewBox="0 0 18 15" width="18px" height="15px">
                            <path
                                d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
                        </svg>
                    </span>
                </label>

                <div class="trigger"><a class="page-link" href="/dev-resources/">
                                Home
                            </a><a class="page-link" href="/dev-resources/resources/">
                                Resources
                            </a><a class="page-link" href="/dev-resources/repos.html">
                                Repos
                            </a><a class="page-link" href="/dev-resources/about.html">
                                About
                            </a></div>
            </nav></div>
</header>
<main class="page-content" aria-label="Content">
        <div class="wrapper">
            <a id="github-edit" href="https://github.com/MichaelCurrin/dev-resources/edit/master/resources/javascript/packages/react/ssr.md">
    üìù <span>Edit page</span>
</a>

            <a id="github-add" href="https://github.com/MichaelCurrin/dev-resources/new/master/resources/javascript/packages/react/">
    ‚ûï <span>Add page</span>
</a>


            

<article class="post">
    <header class="post-header">
        <h1 class="post-title">
            


            <span>Server-Side Rendering</span>
        </h1>

        
            <blockquote>
                <p>SSR in the context of React</p>

            </blockquote>
        
    </header>

    


    <div id="breadcrumbs">

    
        

        
            
            <a href="/dev-resources/resources/">
    Resources
</a>

        
     
        
            /
        

        
            
            <a href="/dev-resources/resources/javascript/">
    JavaScript
</a>

        
     
        
            /
        

        
            
            <a href="/dev-resources/resources/javascript/packages/">
    Packages
</a>

        
     
        
            /
        

        
            
            <a href="/dev-resources/resources/javascript/packages/react/">
    React-related
</a>

        
     
        
            /
        

        
            <a href="/dev-resources/resources/javascript/packages/react/ssr.html" class="underline">
                Server-Side Rendering
            </a>
        
     
    </div>



    <br>

    <div class="post-content">
        
            





<h2 id="summary">Summary</h2>

<h3 id="flow">Flow</h3>

<p>A Node (or Deno) server running React renders HTML, which can be rendered even by a crawler, or a browser that has JS disabled. This initial app view is not interctive. Then the JS assets load later and the app becomes interacive.</p>

<h3 id="benefits">Benefits</h3>

<ul>
  <li>Faster initial page load (the JS assets have to be fetched and run, just HTML to make the DOM.</li>
  <li>The page loads even if JS is disabled or not compatible on the current browser (not that interaction with the page could still break).</li>
  <li>Search engine crawlers can now crawl the whole site, even if they don‚Äôt support JS or have limited budget for crawling a JS-based site (even Googlebot has this limitation).</li>
  <li>You can insert data from an external source like a database in your HTML content (like PHP or Flask or Express apps).</li>
</ul>

<h3 id="downsides">Downsides</h3>

<ul>
  <li>Extra code and complexity needed in the app.</li>
  <li>Node server needed in production. Overhead, cost, hosting, maintenance.</li>
</ul>

<h2 id="why-ssr">Why SSR?</h2>

<p>Based on tutorial - <a href="https://dev.to/marvelouswololo/how-to-server-side-render-react-hydrate-it-on-the-client-and-combine-client-and-server-routes-1a3p">How to server-side render React, hydrate it on the client and combine client and server routes</a>.</p>

<p>I set up a client-side React app with some components including an incrementing counter.</p>

<p>See <a href="https://github.com/MichaelCurrin/react-ssr-quickstart/blob/main/README.md">react-ssr-quickstart</a> for more info and a minimal SSR React app you can run.</p>

<p>On initial page load without JS running, a user or a search engine crawler will see an empty page. So we add a server-side Express app that return an HTML page which acts as a fully-rendered starting point that needs no JS to view in the browser.</p>

<p>We do this by calling <code class="language-plaintext highlighter-rouge">ReactDOMServer.renderToString</code>, which unfortunately freezes the app so that ignores user interaction. This is solved by calling <code class="language-plaintext highlighter-rouge">React.hydrate</code> on the client, so that the browser can make the initial HTML and turn it into a dynamic app in the usual SPA style.</p>

<p>The benefit is your page will load faster for users and the search engines will crawl and rank your site better. The downside is that this adds extra overhead to your app structure and also requires you to have a Node Express server running. While with the plain SPA flow, you build your app to output as static assets and host those somewhere like GitHub Pages without the need for Node.</p>

<h2 id="caution">Caution</h2>

<p>The Server-Side Rendering may not be right for you.</p>

<p>If you want to improve the performance of your app or improve SEO rankings, considering adding a pre-rendering tool at built time like <a href="https://github.com/egoist/presite#examples">presite</a>, or use a static site generator that is built on React.</p>

<p>If you content is static (based on commits and not on user activity in database), then static rendering works great. It will also be faster then SSR, as you can output static assets which get served using a static web server like Nginx which will be more optimized and performant than a Node server.</p>

<h2 id="info-on-ssr-from-react-on-github">Info on SSR from React on GitHub</h2>

<p>From discussion on GitHub - <a href="https://github.com/reactwg/react-18/discussions/37">New Suspense SSR Architecture in React 18</a>.</p>

<blockquote>
  <p>Server-side rendering (abbreviated to ‚ÄúSSR‚Äù in this post) lets you generate HTML from React components on the server, and send that HTML to your users. SSR lets your users see the page‚Äôs content before your JavaScript bundle loads and runs.</p>
</blockquote>

<blockquote>
  <p>SSR in React always happens in several steps:</p>

  <ol>
    <li>On the server, fetch data for the entire app.</li>
    <li>Then, on the server, render the entire app to HTML and send it in the response.</li>
    <li>Then, on the client, load the JavaScript code for the entire app.</li>
    <li>Then, on the client, connect the JavaScript logic to the server-generated HTML for the entire app (this is ‚Äúhydration‚Äù)</li>
  </ol>
</blockquote>

<p>Those all happen in a sequence. With Suspense in React 18, those happen happen for units of the app, making them independent and loading better.</p>

<blockquote>
  <p>What Are the Problems with SSR Today?</p>

  <ul>
    <li>You have to fetch everything before you can show anything</li>
    <li>You have to load everything before you can hydrate anything</li>
    <li>You have to hydrate everything before you can interact with anything</li>
  </ul>
</blockquote>

<p>On the last point - I set up a SSR React app before without the hydration step, which means the app is rendered using HTML and no JS, but the app is frozen. You need the hydration step to make it interactive.</p>

<h2 id="links">Links</h2>

<ul>
  <li><a href="https://reactjs.org/docs/react-dom.html#hydrate">React.hydrate</a> in the docs.</li>
  <li><a href="https://blog.somewhatabstract.com/2020/03/16/hydration-and-server-side-rendering/">Hydration and Server-side Rendering</a> blog post series around React.</li>
  <li><a href="https://doordash.engineering/2022/03/29/improving-web-page-performance-at-doordash-throughserver-side-rendering-with-next-js/">Improving Web Page Performance at DoorDash Through Server-Side Rendering with Next.JS</a></li>
</ul>


        
    </div>
</article>

        </div>
    </main>
<footer class="site-footer h-card">
    <data class="u-url" href="/dev-resources/"></data>

    <div class="wrapper">

        <h2 class="footer-heading">Dev Resources</h2>

        <div class="footer-col-wrapper">
            <div class="footer-col footer-col-1">
                <ul class="contact-list"><li class="p-name">
                            Michael Currin
                        </li></ul>
            </div>

            <div class="footer-col footer-col-2">
<ul class="social-media-list"><li>
            <a href="https://github.com/MichaelCurrin"><svg class="svg-icon">
                    <use xlink:href="/dev-resources/assets/fractal-social-icons.svg#github"></use>
                </svg> <span class="username">MichaelCurrin</span></a>
        </li></ul>
</div>

            <div class="footer-col footer-col-3">
                <p>Links to tutorials/articles/docs/Wikipedia about programming languages, developers tools and services</p>
            </div>
        </div>

    </div>

</footer>
<a href="https://github.com/MichaelCurrin/dev-resources"
    class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

</body>

</html>
